import{j as e}from"./jsx-runtime-ffb262ed.js";import{h as j,r as R,e as b,i as k,g as w}from"./firebase-79125986.js";import{r as i}from"./index-76fb7be0.js";import{B as l}from"./Button-5075d3c0.js";import{a as A,c as N}from"./index-95a7abba.js";import{m as M}from"./index-798baf75.js";import{n as c}from"./subjects-5c717a40.js";import{I}from"./IconTrash-4fb3a008.js";import{c as x}from"./createReactComponent-d5b921f8.js";var S=x("microphone","IconMicrophone",[["path",{d:"M9 2m0 3a3 3 0 0 1 3 -3h0a3 3 0 0 1 3 3v5a3 3 0 0 1 -3 3h0a3 3 0 0 1 -3 -3z",key:"svg-0"}],["path",{d:"M5 10a7 7 0 0 0 14 0",key:"svg-1"}],["path",{d:"M8 21l8 0",key:"svg-2"}],["path",{d:"M12 17l0 4",key:"svg-3"}]]),_=x("player-stop","IconPlayerStop",[["path",{d:"M5 5m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z",key:"svg-0"}]]);const f=({setAudio:r})=>{const[t,g]=i.useState(null),[n,d]=i.useState(null),[u,p]=i.useState(null),m=A(N),y=()=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(o=>{const a=new MediaRecorder(o);g(a),a.start(),a.ondataavailable=s=>{v(new Blob([s.data],{type:"audio/webm"}))}})},v=o=>{if(!o||!m.uid)return null;d(o);const a=R(b,`/audio/${m.uid}/${M()}.mp3`);p(a),k(a,o).then(s=>{console.log("Uploaded a blob or file!",s),w(s.ref).then(h=>{console.log(h),r(h),c.next({message:"Audio upload successful.",type:"info"})})}).catch(s=>{c.next({message:"Audio upload failed. Please try again.",type:"error"})})};return e.jsxs("div",{className:"flex items-center justify-center h-24 bg-white shadow",children:[n?e.jsxs(e.Fragment,{children:[e.jsx("audio",{src:URL.createObjectURL(n),controls:!0}),e.jsx(l,{variant:"text",size:"none",onClick:async()=>{u&&(await j(u),p(null),r(null),d(null),c.next({message:"Audio file deleted."}))},children:e.jsx(I,{className:"text-red-500"})})]}):null,(t==null?void 0:t.state)!=="recording"?n?null:e.jsx("div",{children:e.jsxs(l,{type:"button",variant:"text",color:"white",size:"none",onClick:y,children:["Record ",e.jsx(S,{className:"inline w-4 h-4"})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex items-center gap-2 py-2 animate-pulse",children:[e.jsx("span",{className:"inline-block w-4 h-4 bg-red-500 rounded-full"})," ",e.jsx("div",{children:"Recording..."})]}),e.jsx("div",{children:e.jsx(l,{type:"button",variant:"text",onClick:()=>{t==null||t.stop()},children:e.jsx("div",{className:"p-1 rounded-full outline outline-black outline-1",children:e.jsx(_,{className:"w-4 h-4 fill-black"})})})})]})]})};try{f.displayName="AudioRecord",f.__docgenInfo={description:"",displayName:"AudioRecord",props:{setAudio:{defaultValue:null,description:"",name:"setAudio",required:!0,type:{name:"(url: string | null) => void"}}}}}catch{}export{f as A};
//# sourceMappingURL=AudioRecord-05b5792e.js.map
